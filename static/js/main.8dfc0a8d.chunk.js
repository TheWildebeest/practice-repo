(this["webpackJsonppractice-repo"]=this["webpackJsonppractice-repo"]||[]).push([[0],[,,,,,,,,function(e,t,a){e.exports={DeparturesSection:"Departures_DeparturesSection__J7_mq",DeparturesTitle:"Departures_DeparturesTitle__2q-4e",StopName:"Departures_StopName__FeT5_",DeparturesList:"Departures_DeparturesList__3Vsqg",Placeholder:"Departures_Placeholder__2URZo"}},function(e,t,a){e.exports={Bus:"DepartureListing_Bus__3-sQZ",BusService:"DepartureListing_BusService__sWAAk",BusDestination:"DepartureListing_BusDestination__1AKPl",BusDepartureTime:"DepartureListing_BusDepartureTime__2MD5G"}},function(e,t,a){e.exports={Heading:"DeparturesHeading_Heading__25uK0",Service:"DeparturesHeading_Service__3Q0or",Destination:"DeparturesHeading_Destination__1oy1S",DepartureTime:"DeparturesHeading_DepartureTime__3M-NE"}},function(e,t,a){e.exports={Main:"App_Main__2OaS0"}},function(e,t,a){e.exports={Header:"Header_Header__2kLgA",red:"Header_red__3_rt-"}},,function(e,t,a){e.exports=a.p+"static/media/logo.7b591356.png"},function(e,t,a){e.exports=a.p+"static/media/honk.8999d3ee.mp3"},function(e,t,a){e.exports={Map:"Map_Map__15Iv9"}},,,function(e,t,a){e.exports=a(28)},,,,,function(e,t,a){},,,,function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(6),o=a.n(i),c=(a(24),a(2)),s=a(3),u=a(4),p=a(5),l=a(11),m=a.n(l),d=a(12),h=a.n(d),f=a(14),_=a.n(f),v=a(15),g=a.n(v),D=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).playHonk=function(){new Audio(g.a).play()},e}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("header",{className:h.a.Header},r.a.createElement("img",{src:_.a,alt:"omnibus logo",onClick:this.playHonk}),r.a.createElement("h1",{"data-subheading":"departures happening near you"},"OMNI",r.a.createElement("span",{className:h.a.red},"BUS")," LIVE"))}}]),a}(n.Component),b=a(8),y=a.n(b),E=a(9),j=a.n(E),N=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.service,a=e.destination,n=e.departureTime;return r.a.createElement("hgroup",{className:j.a.Bus},r.a.createElement("h3",{className:j.a.BusService},t),r.a.createElement("h3",{className:j.a.BusDestination},a),r.a.createElement("h3",{className:j.a.BusDepartureTime},n))}}]),a}(n.Component),S=a(10),O=a.n(S),k=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.service,a=e.destination,n=e.departureTime;return r.a.createElement("hgroup",{className:O.a.Heading},r.a.createElement("h3",{className:O.a.Service},t),r.a.createElement("h3",{className:O.a.Destination},a),r.a.createElement("h3",{className:O.a.DepartureTime},n))}}]),a}(n.Component),T=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).listDepartures=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{service:"Service",destination:"Destination",departureTime:"Departing"}),e.map((function(e){return r.a.createElement(N,{service:e.service?e.service:"",destination:e.destination?e.destination:"",departureTime:e.departureTime?e.departureTime:""})})))},e.placeholder=function(){return r.a.createElement("h3",{className:y.a.Placeholder},"Live departures will show here!")},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.stopName,a=e.departures;return r.a.createElement("section",{className:y.a.DeparturesSection},r.a.createElement("div",{className:y.a.DeparturesTitle},r.a.createElement("h2",{className:y.a.StopName},t||"Click anywhere on the map to get started")),r.a.createElement("div",{className:y.a.DeparturesList},a[0]&&a[0].service?this.listDepartures(a):this.placeholder()))}}]),a}(n.Component),L=a(16),B=a.n(L),w=a(17),H=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r)))._setLocationState=function(t){var a=t.lat,n=t.lng;e.props.setLocationState(a,n)},e.defaultLocation={address:"London",lat:51.501904,lng:-.115871},e}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("section",{id:B.a.Map},r.a.createElement(w.a,{bootstrapURLKeys:{key:"AIzaSyB9SARU4o0HtipTD3Z6qIqDQ5lg9ZRp_ok"},defaultCenter:this.defaultLocation,defaultZoom:11,layerTypes:["TransitLayer"],onClick:this._setLocationState}))}}]),a}(n.Component),A=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).setLocationState=function(e,t){n.setState({latitude:Number(Math.round(e+"e6")+"e-6").toString(),longitude:Number(Math.round(t+"e6")+"e-6").toString()})},n.filterData=function(e){var t=Object.entries(e.departures);return(t=t.map((function(e){return e[1][0]}))).map((function(e){return{service:e.line_name,destination:e.direction,departureTime:e.best_departure_estimate}}))},n.fetchAtcoCode=function(){var e="22da4709b682eb9ec88c9e39e2ce4cc7",t="26bf3c4f",a=n.state,r=a.latitude,i=a.longitude;fetch("https://transportapi.com/v3/uk/places.json?places.json?&app_id=".concat(t,"&app_key=").concat(e,"&lat=").concat(r,"&lon=").concat(i,"&type=bus_stop")).then((function(e){return e.json()})).then((function(e){return e.member[0].atcocode})).then((function(a){return fetch("https://transportapi.com/v3/uk/bus/stop/".concat(a,"/live.json?app_id=").concat(t,"&app_key=").concat(e,"&group=route&limit=1&nextbuses=no")).then((function(e){return e.json()}))})).then((function(e){return n.setState({stopName:e.name}),e})).then((function(e){return n.filterData(e)})).then((function(e){return n.setState({departures:e})})).catch((function(e){return alert(e.message)}))},n.state={latitude:51.489165,longitude:-.142499,stopName:"",departures:[{service:"",destination:"",departureTime:""},{service:"",destination:"",departureTime:""}]},n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e,t){this.state.latitude!==t.latitude||this.state.longitude!==t.longitude?(this.fetchAtcoCode(),console.log("Bus stop updated")):console.log("No change")}},{key:"render",value:function(){var e=this.state,t=e.stopName,a=e.departures;return r.a.createElement("div",{className:m.a.App},r.a.createElement(D,null),r.a.createElement("main",{className:m.a.Main},r.a.createElement(T,{stopName:t,departures:a}),r.a.createElement(H,{setLocationState:this.setLocationState})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[19,1,2]]]);
//# sourceMappingURL=main.8dfc0a8d.chunk.js.map